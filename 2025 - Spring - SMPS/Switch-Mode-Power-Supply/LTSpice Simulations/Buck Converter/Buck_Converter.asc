Version 4
SHEET 1 5444 1484
WIRE -32 -16 -64 -16
WIRE 16 -16 -32 -16
WIRE 272 -16 112 -16
WIRE 352 -16 272 -16
WIRE 432 -16 352 -16
WIRE 592 -16 512 -16
WIRE 784 -16 592 -16
WIRE 992 -16 784 -16
WIRE -1488 16 -1536 16
WIRE -1440 16 -1488 16
WIRE -1312 16 -1376 16
WIRE -1296 16 -1312 16
WIRE -1152 16 -1200 16
WIRE -1120 16 -1152 16
WIRE -672 32 -704 32
WIRE -640 32 -672 32
WIRE -1536 48 -1536 16
WIRE -1200 48 -1200 16
WIRE 16 48 16 -16
WIRE 112 48 112 -16
WIRE -1376 64 -1376 16
WIRE -640 64 -640 32
WIRE 992 80 992 -16
WIRE 352 96 352 -16
WIRE 592 96 592 -16
WIRE 32 144 -16 144
WIRE 96 144 96 96
WIRE 96 144 32 144
WIRE -800 160 -880 160
WIRE -752 160 -800 160
WIRE -1536 176 -1536 128
WIRE -1376 176 -1376 144
WIRE -1200 176 -1200 128
WIRE -640 176 -640 144
WIRE -640 176 -688 176
WIRE -576 176 -640 176
WIRE -544 176 -576 176
WIRE -816 192 -880 192
WIRE -752 192 -816 192
WIRE 352 256 352 160
WIRE 592 256 592 160
WIRE 992 256 992 160
WIRE -992 368 -992 -160
WIRE -112 368 -112 -160
WIRE -112 368 -992 368
WIRE 1152 368 1152 -160
WIRE 1152 368 -112 368
WIRE -704 496 -768 496
WIRE -656 496 -704 496
WIRE -400 496 -656 496
WIRE -48 512 -80 512
WIRE 0 512 -48 512
WIRE 256 512 96 512
WIRE 336 512 256 512
WIRE 416 512 336 512
WIRE 576 512 496 512
WIRE 768 512 576 512
WIRE 976 512 768 512
WIRE -656 528 -656 496
WIRE -400 528 -400 496
WIRE -784 576 -848 576
WIRE -704 576 -784 576
WIRE 0 576 0 512
WIRE 96 576 96 512
WIRE 336 608 336 512
WIRE 976 608 976 512
WIRE 576 624 576 512
WIRE -848 640 -848 576
WIRE -768 640 -848 640
WIRE -656 656 -656 608
WIRE -656 656 -704 656
WIRE -592 656 -656 656
WIRE -512 656 -592 656
WIRE -768 672 -832 672
WIRE -400 672 -400 608
WIRE -400 672 -448 672
WIRE -352 672 -400 672
WIRE -304 672 -352 672
WIRE 16 672 -32 672
WIRE 80 672 80 624
WIRE 80 672 16 672
WIRE -512 688 -576 688
WIRE 208 688 144 688
WIRE 288 688 208 688
WIRE -832 720 -832 672
WIRE -576 736 -576 688
WIRE 336 784 336 704
WIRE 576 784 576 688
WIRE 976 784 976 688
WIRE -992 832 -992 368
WIRE -112 848 -112 368
WIRE 1152 848 1152 368
FLAG -1312 16 MCU_PWM
FLAG -1488 16 VIN
FLAG -1376 176 0
FLAG -1536 176 0
FLAG 336 784 0
FLAG 16 672 PWM2
FLAG 768 512 VOUT2
FLAG 256 512 SW2
FLAG -48 512 VIN
FLAG 576 784 0
FLAG 976 784 0
FLAG -576 176 PWM
FLAG -1200 176 0
FLAG -672 32 VIN
FLAG -1152 16 3V3
FLAG -800 160 3V3
FLAG 208 688 nPWM2
FLAG -832 720 0
FLAG -576 736 0
FLAG -592 656 nPWM2
FLAG -352 672 PWM2
FLAG 352 256 0
FLAG 32 144 PWM
FLAG 784 -16 VOUT1
FLAG 272 -16 SW1
FLAG -32 -16 VIN
FLAG 592 256 0
FLAG 992 256 0
FLAG -784 576 MCU_PWM
FLAG -704 496 VIN
FLAG -816 192 MCU_PWM
SYMBOL voltage -1536 32 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 12
SYMBOL voltage -1376 48 R0
WINDOW 3 -70 166 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE(0 3.3 0 1n 1n {D*20u} 20u)
SYMATTR InstName V2
SYMBOL res -656 48 R0
SYMATTR InstName R2
SYMATTR Value 1k
SYMBOL ind 400 528 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L2
SYMATTR Value 680µ
SYMBOL cap 560 624 R0
SYMATTR InstName C2
SYMATTR Value 10µ
SYMBOL res 960 592 R0
SYMATTR InstName RLoad
SYMATTR Value 100
SYMBOL nmos 0 624 R270
SYMATTR InstName M4
SYMATTR Value IRLHM630
SYMBOL AutoGenerated\\BSS138_ZTX -720 176 M0
SYMATTR InstName U2
SYMBOL voltage -1200 32 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value 3.3
SYMBOL AutoGenerated\\BSS138_ZTX -736 656 M0
SYMATTR InstName U1
SYMBOL AutoGenerated\\BSS138_ZTX -480 672 M0
SYMATTR InstName U3
SYMBOL res -672 512 R0
SYMATTR InstName R1
SYMATTR Value 1k
SYMBOL res -416 512 R0
SYMATTR InstName R3
SYMATTR Value 1k
SYMBOL nmos 288 608 R0
SYMATTR InstName M1
SYMATTR Value IRLHM630
SYMBOL ind 416 0 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 680µ
SYMBOL cap 576 96 R0
SYMATTR InstName C1
SYMATTR Value 10µ
SYMBOL res 976 64 R0
SYMATTR InstName RLoad1
SYMATTR Value 100
SYMBOL nmos 16 96 R270
SYMATTR InstName M2
SYMATTR Value IRLHM630
SYMBOL schottky 368 160 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value MBR20100CT
SYMATTR Description Diode
SYMATTR Type diode
TEXT -1416 464 Left 2 !.tran 0.5
TEXT 512 -88 Left 2 ;Higher inductor value limits peak current output, peak\nvoltage output, and slows down system.
TEXT -1448 240 Left 2 !.param D=0.1
TEXT -1552 -56 Left 2 ;PWM follows MCU input at Vin logic level
TEXT 1216 -120 Left 2 ;Need to test it at various loads:\n- No load     (failed)\n- 100 Ohm   (good)\n- 1kOhm      (good)\n- 10kOhm    (good)\n- 100kOhm  (good)\n \nThey work, but PWM is dependent on the resistance.\nHigher the resistance, lower the duty cycle needed\nfor higher voltages. All resistances can output 1V - 10V\nhowever. Thus, feedback circuit is mandatory.\n \nLower Duty Cycle Bound: 10%\nUpper Duty Cycle Bound: 95%
TEXT -512 24 Left 2 ;Pull up can't be too high\nbecause tau = R*C and\ntakes too long for PWM \npeak to charge at low \nduty cycle. Need 1k or else\npower burned is too much.
TEXT -376 -280 Left 7 ;Buck Converter
TEXT -680 648 Right 2 ;D
TEXT -776 632 Right 2 ;G
TEXT -776 664 Right 2 ;S
TEXT -424 664 Right 2 ;D
TEXT -520 648 Right 2 ;G
TEXT -520 680 Right 2 ;S
TEXT -696 768 Left 2 ;nPWM2 is inverse\nlogic level
TEXT -384 760 Left 2 ;PWM2 follows\nlogic level
TEXT 624 192 Left 2 ;Higher capacitance increases\npeak current output, peak \nvoltage output, and slows\ndown system.
TEXT 48 -144 Left 5 ;Asynchronous Buck Converter
TEXT 120 408 Left 5 ;Synchronous Buck Converter
TEXT 1216 408 Left 2 ;Synchronous is more efficient at lower duty cycles.\nDC @ 0.1 --> Async ==> 0.853V, Sync ==> 1.03V\nSync also had more ripples.\n \nThere seems to be little difference between sync & aysnc.\nDC @ 0.93 --> Async ==> 10.25V, Sync ==> 10.21V\nSync has more ripples, however.\n \nTherefore, will be using synchronous design.\n \nPower consumption is also an issue, so need a greater\nresistance, so sync design is not viable.
TEXT -1512 312 Left 2 ;Target voltage range: 1V - 10V
TEXT -888 424 Left 5 ;Logical Level Shift 2
TEXT -848 -128 Left 5 ;Logical Level Shift 1
