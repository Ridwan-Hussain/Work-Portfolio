Version 4
SHEET 1 3372 1440
WIRE 2048 336 2032 336
WIRE 2080 336 2048 336
WIRE 1344 368 1280 368
WIRE 1408 368 1344 368
WIRE 2080 368 2080 336
WIRE 1280 384 1280 368
WIRE 1840 384 1808 384
WIRE 1872 384 1840 384
WIRE 1808 464 1808 384
WIRE 1968 464 1808 464
WIRE 1280 480 1280 464
WIRE 2080 480 2080 448
WIRE 2080 480 2032 480
WIRE 2128 480 2080 480
WIRE 2176 480 2128 480
WIRE 1808 496 1808 464
WIRE 1968 496 1888 496
WIRE 1328 544 1280 544
WIRE 1376 544 1328 544
WIRE 1280 560 1280 544
WIRE 1728 608 1664 608
WIRE 1808 608 1808 576
WIRE 1808 608 1728 608
WIRE 1888 608 1888 496
WIRE 1888 608 1808 608
WIRE 1280 656 1280 640
WIRE 1328 720 1280 720
WIRE 1376 720 1328 720
WIRE 1280 736 1280 720
WIRE 1920 800 1904 800
WIRE 1952 800 1920 800
WIRE 2208 800 1952 800
WIRE 1280 832 1280 816
WIRE 1952 832 1952 800
WIRE 2208 832 2208 800
WIRE 1824 880 1760 880
WIRE 1904 880 1824 880
WIRE 1760 944 1760 880
WIRE 1840 944 1760 944
WIRE 1952 960 1952 912
WIRE 1952 960 1904 960
WIRE 2016 960 1952 960
WIRE 2096 960 2016 960
WIRE 1840 976 1776 976
WIRE 2208 976 2208 912
WIRE 2208 976 2160 976
WIRE 2256 976 2208 976
WIRE 2304 976 2256 976
WIRE 2096 992 2032 992
WIRE 1776 1024 1776 976
WIRE 2032 1040 2032 992
FLAG 1344 368 MCU_PWM
FLAG 1328 720 HV
FLAG 1280 832 0
FLAG 1280 480 0
FLAG 1776 1024 0
FLAG 2032 1040 0
FLAG 2016 960 nPWM2
FLAG 2256 976 PWM2
FLAG 1328 544 3V3
FLAG 1280 656 0
FLAG 1920 800 HV
FLAG 1840 384 3V3
FLAG 2048 336 HV
FLAG 2128 480 PWM
FLAG 1728 608 MCU_PWM
FLAG 1824 880 MCU_PWM
SYMBOL AutoGenerated\\BSS138_ZTX 1872 960 M0
SYMATTR InstName U1
SYMBOL voltage 1280 720 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 12
SYMBOL voltage 1280 368 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value PULSE(0 3.3 0 1n 1n {D*20u} 20u)
SYMBOL AutoGenerated\\BSS138_ZTX 2128 976 M0
SYMATTR InstName U3
SYMBOL voltage 1280 544 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value 3.3
SYMBOL res 1936 816 R0
SYMATTR InstName R1
SYMATTR Value 1k
SYMBOL res 2192 816 R0
SYMATTR InstName R2
SYMATTR Value 1k
SYMBOL AutoGenerated\\BSS138_ZTX 2000 480 M0
SYMATTR InstName U2
SYMBOL res 1792 480 R0
SYMATTR InstName R3
SYMATTR Value 10k
SYMBOL res 2064 352 R0
SYMATTR InstName R4
SYMATTR Value 1k
TEXT 1304 840 Left 2 !.tran .1m
TEXT 1928 952 Right 2 ;D
TEXT 1832 936 Right 2 ;G
TEXT 1832 968 Right 2 ;S
TEXT 2184 968 Right 2 ;D
TEXT 2088 952 Right 2 ;G
TEXT 2088 984 Right 2 ;S
TEXT 1424 152 Left 5 ;Level Shift Logic from 3.3V to 5V
TEXT 1896 1080 Left 2 ;nPWM2 is inverse\nlogic level
TEXT 2256 1080 Left 2 ;PWM2 follows\nlogic level
TEXT 1440 352 Left 2 ;Logic Level
TEXT 1392 704 Left 2 ;Increased VDD \nlogic level
TEXT 2056 472 Right 2 ;D
TEXT 1960 456 Right 2 ;G
TEXT 1960 488 Right 2 ;S
TEXT 1840 280 Left 3 ;Logical Shift Follower
TEXT 2024 712 Center 3 ;Logical Shift\nInverter and Follower
TEXT 1304 488 Left 2 !.param D=0.1
TEXT 2192 368 Left 2 ;Pull up can't be too high because\ntau = R*C and takes too long for\nPWM peak to charge at low duty cycle\n(especially for higher voltages).
